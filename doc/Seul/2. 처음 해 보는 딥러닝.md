# 미지의 힘을 예측하는 힘
- 머신러닝은 기존 데이터를 이용해 아직 일어나지 않은 미지의 일을 예측하기 위해 만들어진 기법
- 데이터강 입력되고 패턴이 분석되는 과정 -> 학습(training)
- 우리가 배우려는 것 : 학습과 예측의 구체적인 과정
- 예측 성공률을 결국 얼마나 정확한 경계선을 긋느냐에 달려있음

# 코드분석
## 코드는 세부분, 즉 '데이터분석과 입력', '딥러닝 실행', '결과 출력'으로 나뉠 수 있음
### 첫 번째 부분: 데이터 분석과 입력
라이브러리를 불러올 때 사용하는 명령어 -> import
>import numpy

넘파이: 수치계산을 위해 만들어진 라이브러리로 데이터 분석에 많이 사용

>Data_set = numpy.loadtxt("../dataset/ThoraricSurgery.csv", delimiter=",")

Data_set 이라는 임시 저장소를 만들고, 넘파이 라이브러리 안에 있는 loadtxt()라는 함수를 사용

이를 이용해 'ThoraricSurgery.csv'라는 외부 데이터셋을 불러옴

- 데이터 파일 보기

293,1,3,0
1,2,2.88,0

보기 쉽게 정리하면

1|2|3|4
----|----|----|----
293|1|3|0
1|2|2.88|1

한줄 한 줄이 각 케이스에 대해 기록한 정보  
쉼표(,)로 이어진 항목이 각 줄마다 4개가 존재  
이 데이터의 목적은 1번째부터 3번째 까지의 항목을 분석해서 4번째 항목을 맞히는 것

1번째 항목부터 3번째 항목 -> **속성(attirbute)**  
4번째 항목 -> **클래스(class)**

딥러닝을 구동시키려면 '속성'만을 뽑아 데이터셋을 만들고, '클래스'를 담는 데이터셋을 또 따로 만들어줘야 함

속성 데이터셋 X 생성
>X = Data_set[:,0:3]

클래스 데이터셋 Y는 4번째 항목을 이용해 만듬
>Y = Data_set[:,17]

----

### 두 번째 부분: 딥러닝 실행

주로 **케라스**(keras)를 사용해 딥러닝을 실행  
케라스가 구동되려면 **텐서플로**(TensorFlow) 라이브러리를 사용

>딥러닝 프로젝트를 '여행'으로 비유해 본다면 텐서플로는 목적지까지 빠르게 이동시켜주는 '비행기'에 해당하고, 케라스는 비행기의 이륙 빛 정확한 지점까지의 도착을 책임지는 '파일럿'에 비유할 수 있음

- 케라스 라이브러리 불러오기
> from keras.models import Sepuential  
from keras.layers import Dense

딥러닝은 여러 층이 쌓여 결과를 만들어냄

Sequential : 집러닝의 구조를 한 층 한 층 쉽게 쌓아올릴 수 있게 해줌  
Sequential 함수를 선언 후 model.add() 함수를 사용해서 필요한 층을 차례로 추가  
필요한 층을 빠르고 쉽게 쌓음

>model = Sequential()  
model.add(Dense(30, input_dim = 3, activation='relu'))  
model.add(Dense(1, activation='sigmoid'))

model.add() 안에는 Dense() 함수가 포함  
각 층이 제각각 어떤 특성을 가징지 옵션 설정

딥러닝의 구조와 층별 옵션을 정하고 나면 compile() 함수를 이용해 이를 실행

>model.compile(loss='mean_squared_error', optimizer='adam', metrics=['accuracy'])  
model.fit(X, Y, epochs, batch_size=10)

activation : 다음 층으로 어떻게 값을 넘길지 결정하는 부분  
loss : 한 번 신경망이 실행됭 때마다 오차 값을 추적하는 함수  
optimize : 오차를 어떻게 줄여 나갈지 정하는 함수  

----

### 마지막 부분: 결과 출력

>#결과를 출력합니다  
print("/n Accuracy : %.4f" % (model.evaluate(X, Y)[1]))

출력 부분에서는 model.evaluate() 함수를 이용해 앞서 만든 딥러닝의 모델이 어느 정도 정확하게 예측하는지 점검  
정확도(Accuracy)는 학습 대상이 되는 데이터 중에 일부를 랜덤하게 추출해, 새 데이터인 것으로 가정하고 테스트한 결과

좀 더 신뢰할 수 있는 정확도를 측정하려면, 학습단계에서 미리 일부를 떼어내어 테스트 셋으로 저장하고 테스트 할 때는 오직 이 테스트셋만을 사용
